# UML Diagrams - Sistem Logistik

## 1. Class Diagram

Diagram ini menunjukkan struktur model/entitas dalam sistem beserta atribut dan method-nya.

```mermaid
classDiagram
    class User {
        +String username
        +String email
        +String password
        +String fullName
        +String role
        +String phone
        +Boolean isActive
        +Date createdAt
        +Date updatedAt
        +comparePassword(candidatePassword) Boolean
    }

    class Customer {
        +String id
        +String name
        +String email
        +String phone
        +String address
        +String company
        +Number totalShipments
        +Boolean isActive
        +Date createdAt
        +Date updatedAt
    }

    class Fleet {
        +String id
        +String plateNumber
        +String type
        +Number capacity
        +String driver
        +String status
        +Date lastMaintenance
        +Date nextMaintenance
        +String fuelType
        +Number year
        +Date createdAt
        +Date updatedAt
    }

    class Shipment {
        +String id
        +Object customer
        +String origin
        +String destination
        +Number weight
        +String status
        +Object fleet
        +Date estimatedDelivery
        +Date actualDelivery
        +String notes
        +Date createdAt
        +Date updatedAt
    }

    class Location {
        +String id
        +String name
        +String cityName
        +String type
        +String address
        +Object coordinates
        +Number latitude
        +Number longitude
        +Number capacity
        +Number currentOccupancy
        +String manager
        +Boolean isActive
        +Date createdAt
        +Date updatedAt
    }

    class ActivityLog {
        +ObjectId user
        +String action
        +String details
        +String ipAddress
        +Date timestamp
        +Date createdAt
        +Date updatedAt
    }

    User "1" --> "*" ActivityLog : creates
    Fleet "0..1" --> "*" Shipment : assigned to
    Customer "1" --> "*" Shipment : places
    Location "1" --> "*" Shipment : origin/destination
```

## 2. Entity Relationship Diagram (ERD)

Diagram ini menunjukkan relasi antar entitas dalam database.

```mermaid
erDiagram
    USER ||--o{ ACTIVITY_LOG : creates
    USER {
        ObjectId _id PK
        String username UK
        String email UK
        String password
        String fullName
        String role
        String phone
        Boolean isActive
        DateTime createdAt
        DateTime updatedAt
    }

    CUSTOMER ||--o{ SHIPMENT : places
    CUSTOMER {
        ObjectId _id PK
        String id UK
        String name
        String email
        String phone
        String address
        String company
        Number totalShipments
        Boolean isActive
        DateTime createdAt
        DateTime updatedAt
    }

    FLEET ||--o{ SHIPMENT : "assigned to"
    FLEET {
        ObjectId _id PK
        String id UK
        String plateNumber UK
        String type
        Number capacity
        String driver
        String status
        Date lastMaintenance
        Date nextMaintenance
        String fuelType
        Number year
        DateTime createdAt
        DateTime updatedAt
    }

    SHIPMENT }o--|| LOCATION : "origin"
    SHIPMENT }o--|| LOCATION : "destination"
    SHIPMENT {
        ObjectId _id PK
        String id UK
        Object customer
        String origin FK
        String destination FK
        Number weight
        String status
        Object fleet
        Date estimatedDelivery
        Date actualDelivery
        String notes
        DateTime createdAt
        DateTime updatedAt
    }

    LOCATION {
        ObjectId _id PK
        String id UK
        String name
        String cityName
        String type
        String address
        Object coordinates
        Number latitude
        Number longitude
        Number capacity
        Number currentOccupancy
        String manager
        Boolean isActive
        DateTime createdAt
        DateTime updatedAt
    }

    ACTIVITY_LOG {
        ObjectId _id PK
        ObjectId user FK
        String action
        String details
        String ipAddress
        DateTime timestamp
        DateTime createdAt
        DateTime updatedAt
    }
```

## 3. Use Case Diagrams

Diagram ini menunjukkan interaksi berbagai role user dengan sistem. Untuk kemudahan pembacaan, diagram dipisah berdasarkan role.

    style LOCATION fill:#AA96DA,stroke:#5F3DC4,stroke-width:2px
    style REPORT fill:#FCBAD3,stroke:#C2255C,stroke-width:2px
```

### 3.2 Use Case Diagram - Manager Role

```mermaid
flowchart TB
    Manager([MANAGER])

    subgraph AUTH[Authentication Module]
        Login[Login]
        Logout[Logout]
    end

    subgraph CUSTOMER[Customer Management Module]
        CreateCustomer[Create Customer]
        UpdateCustomer[Update Customer]
        ViewCustomers[View Customers]
    end

    subgraph FLEET[Fleet Management Module]
        CreateFleet[Create Fleet]
        UpdateFleet[Update Fleet]
        ViewFleets[View Fleets]
        FleetMaintenance[Manage Fleet Maintenance]
    end

    subgraph LOCATION[Location Management Module]
        CreateLocation[Create Location]
        UpdateLocation[Update Location]
        ViewLocations[View Locations]
    end

    subgraph SHIPMENT[Shipment Management Module]
        CreateShipment[Create Shipment]
        UpdateShipment[Update Shipment Status]
        AssignFleet[Assign Fleet to Shipment]
        ViewShipments[View Shipments]
    end

    subgraph REPORT[Reports & Analytics Module]
        ViewDashboard[View Dashboard]
        GenerateReports[Generate Reports]
        ViewActivityLogs[View Activity Logs]
    end

    Manager --> Login
    Manager --> Logout

    Manager --> CreateCustomer
    Manager --> UpdateCustomer
    Manager --> ViewCustomers

    Manager --> CreateFleet
    Manager --> UpdateFleet
    Manager --> ViewFleets
    Manager --> FleetMaintenance

    Manager --> CreateLocation
    Manager --> UpdateLocation
    Manager --> ViewLocations

    Manager --> CreateShipment
    Manager --> UpdateShipment
    Manager --> AssignFleet
    Manager --> ViewShipments

    Manager --> ViewDashboard
    Manager --> GenerateReports
    Manager --> ViewActivityLogs

    CreateShipment -.includes.-> ViewCustomers
    AssignFleet -.includes.-> ViewFleets

    style Manager fill:#845EC2,stroke:#5F3DC4,stroke-width:4px,color:#fff
    style AUTH fill:#FFE66D,stroke:#F59F00,stroke-width:2px
    style CUSTOMER fill:#95E1D3,stroke:#087F5B,stroke-width:2px
    style FLEET fill:#F38181,stroke:#C92A2A,stroke-width:2px
    style LOCATION fill:#AA96DA,stroke:#5F3DC4,stroke-width:2px
    style SHIPMENT fill:#00D2FC,stroke:#0B7285,stroke-width:2px
    style REPORT fill:#FCBAD3,stroke:#C2255C,stroke-width:2px
```

### 3.3 Use Case Diagram - Staff Role

```mermaid
flowchart TB
    Staff([STAFF])

    subgraph AUTH[Authentication Module]
        Login[Login]
        Logout[Logout]
    end

    subgraph CUSTOMER[Customer Management Module]
        ViewCustomers[View Customers]
    end

    subgraph SHIPMENT[Shipment Management Module]
        CreateShipment[Create Shipment]
        UpdateShipment[Update Shipment Status]
        TrackShipment[Track Shipment]
        ViewShipments[View Shipments]
    end

    subgraph REPORT[Dashboard Module]
        ViewDashboard[View Dashboard]
    end

    Staff --> Login
    Staff --> Logout
    Staff --> ViewCustomers
    Staff --> CreateShipment
    Staff --> UpdateShipment
    Staff --> TrackShipment
    Staff --> ViewShipments
    Staff --> ViewDashboard

    CreateShipment -.includes.-> ViewCustomers

    style Staff fill:#00C9A7,stroke:#087F5B,stroke-width:4px,color:#fff
    style AUTH fill:#FFE66D,stroke:#F59F00,stroke-width:2px
    style CUSTOMER fill:#95E1D3,stroke:#087F5B,stroke-width:2px
    style SHIPMENT fill:#00D2FC,stroke:#0B7285,stroke-width:2px
    style REPORT fill:#FCBAD3,stroke:#C2255C,stroke-width:2px
```

### 3.4 Use Case Diagram - Driver Role

```mermaid
flowchart TB
    Driver([DRIVER])

    subgraph AUTH[Authentication Module]
        Login[Login]
        Logout[Logout]
    end

    subgraph SHIPMENT[Shipment Operations Module]
        UpdateShipment[Update Shipment Status]
        TrackShipment[Track Shipment]
        ViewShipments[View Assigned Shipments]
    end

    subgraph REPORT[Dashboard Module]
        ViewDashboard[View Dashboard]
    end

    Driver --> Login
    Driver --> Logout
    Driver --> UpdateShipment
    Driver --> TrackShipment
    Driver --> ViewShipments
    Driver --> ViewDashboard

    style Driver fill:#FF6F59,stroke:#C92A2A,stroke-width:4px,color:#fff
    style AUTH fill:#FFE66D,stroke:#F59F00,stroke-width:2px
    style SHIPMENT fill:#00D2FC,stroke:#0B7285,stroke-width:2px
    style REPORT fill:#FCBAD3,stroke:#C2255C,stroke-width:2px
```

### 3.5 Use Case Diagram - System Overview (All Roles)

```mermaid
flowchart LR
    Admin([ADMIN])
    Manager([MANAGER])
    Staff([STAFF])
    Driver([DRIVER])

    subgraph SYSTEM[Logistic Management System]
        direction TB

        Auth[Authentication]
        UserMgmt[User Management]
        CustomerMgmt[Customer Management]
        FleetMgmt[Fleet Management]
        LocationMgmt[Location Management]
        ShipmentMgmt[Shipment Management]
        Reports[Reports & Analytics]
    end

    Admin -.Full Access.-> UserMgmt
    Admin -.Full Access.-> CustomerMgmt
    Admin -.Full Access.-> FleetMgmt
    Admin -.Full Access.-> LocationMgmt
    Admin -.Full Access.-> Reports

    Manager -.Manage.-> CustomerMgmt
    Manager -.Manage.-> FleetMgmt
    Manager -.Manage.-> LocationMgmt
    Manager -.Manage.-> ShipmentMgmt
    Manager -.View.-> Reports

    Staff -.Create/Update.-> ShipmentMgmt
    Staff -.View.-> CustomerMgmt

    Driver -.Update Status.-> ShipmentMgmt

    Admin --> Auth
    Manager --> Auth
    Staff --> Auth
    Driver --> Auth

    style Admin fill:#FF6B6B,stroke:#C92A2A,stroke-width:4px,color:#fff
    style Manager fill:#845EC2,stroke:#5F3DC4,stroke-width:4px,color:#fff
    style Staff fill:#00C9A7,stroke:#087F5B,stroke-width:4px,color:#fff
    style Driver fill:#FF6F59,stroke:#C92A2A,stroke-width:4px,color:#fff
    style SYSTEM fill:#F8F9FA,stroke:#495057,stroke-width:3px
```

## 4. Sequence Diagram - Create Shipment Flow

Diagram ini menunjukkan alur proses pembuatan shipment baru.

```mermaid
sequenceDiagram
    actor User as Staff/Manager
    participant Frontend
    participant API as Backend API
    participant Auth as Auth Middleware
    participant Controller as Shipment Controller
    participant DB as MongoDB
    participant Logger as Activity Log

    User->>Frontend: Fill shipment form
    Frontend->>Frontend: Validate input
    Frontend->>API: POST /api/shipments
    API->>Auth: Verify JWT token
    Auth->>Auth: Check user role

    alt Token invalid
        Auth-->>Frontend: 401 Unauthorized
        Frontend-->>User: Show error message
    else Token valid
        Auth->>Controller: Forward request
        Controller->>DB: Check customer exists

        alt Customer not found
            DB-->>Controller: Customer not found
            Controller-->>Frontend: 404 Not Found
            Frontend-->>User: Show error
        else Customer exists
            DB-->>Controller: Customer data
            Controller->>DB: Check fleet availability

            alt Fleet available
                DB-->>Controller: Fleet data
                Controller->>DB: Create shipment
                DB-->>Controller: Shipment created
                Controller->>Logger: Log activity
                Logger->>DB: Save activity log
                Controller-->>Frontend: 201 Created + shipment data
                Frontend-->>User: Show success message
            else Fleet not available
                DB-->>Controller: No fleet available
                Controller->>DB: Create shipment (pending)
                DB-->>Controller: Shipment created
                Controller->>Logger: Log activity
                Controller-->>Frontend: 201 Created (pending fleet)
                Frontend-->>User: Show warning (no fleet)
            end
        end
    end
```

## 5. Sequence Diagram - Update Shipment Status Flow

Diagram ini menunjukkan alur proses update status shipment.

```mermaid
sequenceDiagram
    actor User as Driver/Staff
    participant Frontend
    participant API as Backend API
    participant Auth as Auth Middleware
    participant Controller as Shipment Controller
    participant DB as MongoDB
    participant Logger as Activity Log

    User->>Frontend: Select shipment
    User->>Frontend: Update status
    Frontend->>API: PUT /api/shipments/:id
    API->>Auth: Verify JWT token
    Auth->>Auth: Check permissions

    alt Unauthorized
        Auth-->>Frontend: 403 Forbidden
        Frontend-->>User: Access denied
    else Authorized
        Auth->>Controller: Forward request
        Controller->>DB: Find shipment by ID

        alt Shipment not found
            DB-->>Controller: Not found
            Controller-->>Frontend: 404 Not Found
            Frontend-->>User: Shipment not found
        else Shipment found
            DB-->>Controller: Shipment data
            Controller->>Controller: Validate status transition

            alt Invalid transition
                Controller-->>Frontend: 400 Bad Request
                Frontend-->>User: Invalid status change
            else Valid transition
                Controller->>DB: Update shipment status

                alt Status = "Delivered"
                    Controller->>DB: Set actualDelivery date
                    Controller->>DB: Update fleet status to "Available"
                end

                DB-->>Controller: Updated shipment
                Controller->>Logger: Log status change
                Logger->>DB: Save activity log
                Controller-->>Frontend: 200 OK + updated data
                Frontend-->>User: Status updated successfully
            end
        end
    end
```

## 6. State Diagram - Shipment Status

Diagram ini menunjukkan state transitions untuk status shipment.

```mermaid
stateDiagram-v2
    [*] --> Pending: Create shipment

    Pending --> InTransit: Assign fleet & dispatch
    Pending --> Cancelled: Cancel by user

    InTransit --> Delivered: Complete delivery
    InTransit --> Cancelled: Cancel shipment

    Delivered --> [*]
    Cancelled --> [*]

    note right of Pending
        Waiting for fleet assignment
    end note

    note right of InTransit
        Fleet assigned and on route
    end note

    note right of Delivered
        Successfully delivered
        actualDelivery date set
    end note

    note right of Cancelled
        Shipment cancelled
        Fleet released
    end note
```

## 7. Component Diagram - System Architecture

Diagram ini menunjukkan arsitektur komponen sistem.

```mermaid
graph TB
    subgraph Frontend[Frontend - React]
        UI[User Interface]
        Components[React Components]
        State[State Management]
        API_Client[API Client/Axios]
    end

    subgraph Backend[Backend - Node.js/Express]
        Routes[Routes Layer]
        Middleware[Middleware Layer]
        Controllers[Controllers Layer]
        Models[Models Layer]
        Utils[Utilities]
    end

    subgraph Database[Database]
        MongoDB[(MongoDB)]
    end

    subgraph Authentication[Authentication]
        JWT[JWT Service]
        BCrypt[Password Hashing]
    end

    UI --> Components
    Components --> State
    State --> API_Client

    API_Client -->|HTTP/REST| Routes
    Routes --> Middleware
    Middleware --> JWT
    Middleware --> Controllers
    Controllers --> Models
    Controllers --> Utils
    Models --> MongoDB

    Controllers --> BCrypt
    Controllers --> JWT

    style Frontend fill:#61DAFB,stroke:#0B7285,stroke-width:3px
    style Backend fill:#68A063,stroke:#2B8A3E,stroke-width:3px
    style Database fill:#47A248,stroke:#2B8A3E,stroke-width:3px
    style Authentication fill:#FFD43B,stroke:#F59F00,stroke-width:3px
```

## 8. Deployment Diagram

Diagram ini menunjukkan deployment architecture sistem.

```mermaid
graph TB
    subgraph Client[Client Side]
        Browser[Web Browser]
    end

    subgraph FrontendServer[Frontend Server]
        ReactApp[React Application<br/>Port: 3000]
    end

    subgraph BackendServer[Backend Server]
        ExpressAPI[Express API<br/>Port: 5000]
    end

    subgraph DatabaseServer[Database Server]
        MongoDBServer[(MongoDB<br/>Port: 27017)]
    end

    Browser -->|HTTP/HTTPS| ReactApp
    ReactApp -->|REST API Calls| ExpressAPI
    ExpressAPI -->|Mongoose ODM| MongoDBServer

    style Client fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    style FrontendServer fill:#61DAFB,stroke:#0B7285,stroke-width:3px
    style BackendServer fill:#68A063,stroke:#2B8A3E,stroke-width:3px
    style DatabaseServer fill:#47A248,stroke:#2B8A3E,stroke-width:3px
```

## 9. Activity Diagram - Fleet Assignment Process

Diagram ini menunjukkan proses assignment fleet ke shipment.

```mermaid
flowchart TD
    Start([Start]) --> CheckShipment{Shipment<br/>exists?}

    CheckShipment -->|No| Error1[Return 404 Error]
    CheckShipment -->|Yes| CheckStatus{Status is<br/>Pending?}

    CheckStatus -->|No| Error2[Return 400 Error:<br/>Cannot assign fleet]
    CheckStatus -->|Yes| GetFleetList[Get available fleets]

    GetFleetList --> CheckCapacity{Fleet capacity<br/>>= shipment weight?}

    CheckCapacity -->|No| NoFleet[No suitable fleet]
    CheckCapacity -->|Yes| AssignFleet[Assign fleet to shipment]

    AssignFleet --> UpdateFleetStatus[Update fleet status<br/>to 'On Route']
    UpdateFleetStatus --> UpdateShipmentStatus[Update shipment status<br/>to 'In Transit']
    UpdateShipmentStatus --> LogActivity[Log activity]
    LogActivity --> Success[Return success response]

    NoFleet --> End1([End - No fleet available])
    Error1 --> End2([End - Error])
    Error2 --> End2
    Success --> End3([End - Success])

    style Start fill:#51CF66,stroke:#2B8A3E,stroke-width:3px
    style Success fill:#51CF66,stroke:#2B8A3E,stroke-width:3px
    style End3 fill:#51CF66,stroke:#2B8A3E,stroke-width:3px
    style Error1 fill:#FF6B6B,stroke:#C92A2A,stroke-width:3px
    style Error2 fill:#FF6B6B,stroke:#C92A2A,stroke-width:3px
    style End1 fill:#FFD43B,stroke:#F59F00,stroke-width:3px
    style End2 fill:#FF6B6B,stroke:#C92A2A,stroke-width:3px
```

---

## Cara Menggunakan Diagram Ini

1. **Untuk melihat diagram**: Buka file ini di editor yang support Mermaid (VS Code dengan extension Mermaid, GitHub, GitLab, dll)
2. **Untuk export**: Gunakan tools seperti:
   - Mermaid Live Editor: https://mermaid.live/
   - VS Code extension: Markdown Preview Mermaid Support
   - CLI: `mmdc -i uml-diagrams.md -o output.pdf`

## Legend

- **PK**: Primary Key
- **FK**: Foreign Key
- **UK**: Unique Key
- **||--o{**: One to Many relationship
- **}o--||**: Many to One relationship
- **-->**: Association/Dependency
- **-.includes.->**: Include relationship
